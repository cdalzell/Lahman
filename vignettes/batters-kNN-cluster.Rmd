---
title: "What groups of batters are there?"
author: "Martin Monkman"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Run Scoring Trends}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## What groups of batters are there? a short introduction to k-NN methods


This vignette demonstrates how to run a k-Nearest Neighbour (k-NN) cluster analysis using R, to find clusters of baseball batters based on their patterns of hitting.

First, we load the necessary packages: `Lahman` (containing the baseball data) and the data carpentry package `dplyr` (version 0.7.0 or higher):


```{r Setup, message=FALSE}

# package load 
library(Lahman)
library(dplyr)

```

#### Read and summarize the data

For this example, we'll use the data table `Batting` in the Lahman database. This table contains a list of the season record for each pitcher; note that if a pitcher was switched teams mid-season (due to a trade, etc.) he will have two records, one for each team. The variable `stint` shows the order of appearance on each team.

(A parallel table `Pitching` has a similar structure.)


Once the table is loaded, the function `battingStats` is run to calculate additional batting statistics, such as the number of plate appearances, batting average, and batting average on balls in play (BABIP).

 - filters to select 2016.
 

```{r, message=FALSE}


data("Batting")

Batting_plus <- battingStats()

Batting_season <- Batting_plus %>%
  filter(yearID == "2016")

Batting_season_n <- Batting_season %>% summarise(n = n())

Batting_season_n

```


For the 2016 season, there were a total of `r Batting_season_n` records.




#### Summary table

The next step is to create a summary table that shows the number of batters used by each team in the 2016 season. This is accomplished using the `group_by()` function.

```{r, message=FALSE}

team_batting <- Batting_season %>%
  group_by(teamID) %>%
  summarise(player_total = n(),
            AB_total = sum(AB),
            PA_total = sum(PA))


team_batting

```





***


#### Further reading:

[Wikipedia: _k_-nearest neighbors algorithm](https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm)

Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani (2013) [_An Introduction to Statistical Learning: with Applications in R_](http://www-bcf.usc.edu/~gareth/ISL/) -- 


David Dialpiaz (2018) [_R for Statistical Learning_](https://daviddalpiaz.github.io/r4sl/k-nearest-neighbors.html) 


-30-